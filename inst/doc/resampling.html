<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>resampling</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">resampling</h1>



<p>The original significance test proposed by Caliskan et al. in their paper is based on exact inference using a permutaion approach. This package provides such an exact test. But like any permutation test (such as Fisher’s exact test), the number of permuations, as well as the running time, grows <em>factorially</em> — O(n!) — with the number of samples (in the case, the total length of S and T). In the “math vs poetry” example used extensively in this package, the total length of S and T is 16. The total number of iterations needed is 16! = 20922789888000. The number grows 306x to 18! = 6402373705728000 by just adding one item each to S and T. It is unrealistic to expect an ordinary computer can do such computation within a reasonable time frame.</p>
<p>In the following benchmark, we studied how much time does it take to finish an exact test with the word set with a length of 2 to 4. I actually don’t recommend trying anything beyond 6; it would take probably a few hours, days even. And actually, the function <code>weat_exact</code> will warn you about that.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(sweater)</a>
<a class="sourceLine" id="cb1-2" title="2">S1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;math&quot;</span>, <span class="st">&quot;algebra&quot;</span>, <span class="st">&quot;geometry&quot;</span>, <span class="st">&quot;calculus&quot;</span>, <span class="st">&quot;equations&quot;</span>,</a>
<a class="sourceLine" id="cb1-3" title="3"> <span class="st">&quot;computation&quot;</span>, <span class="st">&quot;numbers&quot;</span>, <span class="st">&quot;addition&quot;</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">T1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;poetry&quot;</span>, <span class="st">&quot;art&quot;</span>, <span class="st">&quot;dance&quot;</span>, <span class="st">&quot;literature&quot;</span>, <span class="st">&quot;novel&quot;</span>, <span class="st">&quot;symphony&quot;</span>, <span class="st">&quot;drama&quot;</span>, <span class="st">&quot;sculpture&quot;</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">A1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;boy&quot;</span>, <span class="st">&quot;brother&quot;</span>, <span class="st">&quot;he&quot;</span>, <span class="st">&quot;him&quot;</span>, <span class="st">&quot;his&quot;</span>, <span class="st">&quot;son&quot;</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">B1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;woman&quot;</span>, <span class="st">&quot;girl&quot;</span>, <span class="st">&quot;sister&quot;</span>, <span class="st">&quot;she&quot;</span>, <span class="st">&quot;her&quot;</span>, <span class="st">&quot;hers&quot;</span>, <span class="st">&quot;daughter&quot;</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8">do_exact_weat &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb1-9" title="9">    sw &lt;-<span class="st"> </span><span class="kw">weat</span>(glove_math, S1[<span class="dv">1</span><span class="op">:</span>n], T1[<span class="dv">1</span><span class="op">:</span>n], A1[<span class="dv">1</span><span class="op">:</span>n], B1[<span class="dv">1</span><span class="op">:</span>n])</a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="kw">weat_exact</span>(sw)</a>
<a class="sourceLine" id="cb1-11" title="11">}</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">require</span>(bench)</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt; Loading required package: bench</span></a>
<a class="sourceLine" id="cb1-15" title="15">benchmark_res &lt;-<span class="st"> </span>bench<span class="op">::</span><span class="kw">mark</span>(<span class="kw">do_exact_weat</span>(<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1-16" title="16">                             <span class="kw">do_exact_weat</span>(<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1-17" title="17">                             <span class="kw">do_exact_weat</span>(<span class="dv">4</span>),</a>
<a class="sourceLine" id="cb1-18" title="18">                             <span class="dt">relative =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">#&gt; Warning: Some expressions had a GC in every iteration; so filtering is disabled.</span></a>
<a class="sourceLine" id="cb1-20" title="20">benchmark_res</a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co">#&gt; # A tibble: 3 × 6</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">#&gt;   expression         min median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co">#&gt;   &lt;bch:expr&gt;       &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">#&gt; 1 do_exact_weat(2)   1      1       698.       4.33     1   </span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">#&gt; 2 do_exact_weat(3)  16.0   15.3      49.9      1        1.66</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">#&gt; 3 do_exact_weat(4) 923.   796.        1        5.66     2.13</span></a></code></pre></div>
<p>Instead, I recommend using the resampling approximation of the exact inference. Actually, in the <a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/DX4VWP/RQ1CIW&amp;version=2.0">Java code</a> provided by Caliskan et al., the same resampling approximation is used.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">set.seed</span>(<span class="dv">11111</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">S1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;math&quot;</span>, <span class="st">&quot;algebra&quot;</span>, <span class="st">&quot;geometry&quot;</span>, <span class="st">&quot;calculus&quot;</span>, <span class="st">&quot;equations&quot;</span>, <span class="st">&quot;computation&quot;</span>, <span class="st">&quot;numbers&quot;</span>, <span class="st">&quot;addition&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">T1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;poetry&quot;</span>, <span class="st">&quot;art&quot;</span>, <span class="st">&quot;dance&quot;</span>, <span class="st">&quot;literature&quot;</span>, <span class="st">&quot;novel&quot;</span>, <span class="st">&quot;symphony&quot;</span>, <span class="st">&quot;drama&quot;</span>, <span class="st">&quot;sculpture&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">A1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;boy&quot;</span>, <span class="st">&quot;brother&quot;</span>, <span class="st">&quot;he&quot;</span>, <span class="st">&quot;him&quot;</span>, <span class="st">&quot;his&quot;</span>, <span class="st">&quot;son&quot;</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">B1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;woman&quot;</span>, <span class="st">&quot;girl&quot;</span>, <span class="st">&quot;sister&quot;</span>, <span class="st">&quot;she&quot;</span>, <span class="st">&quot;her&quot;</span>, <span class="st">&quot;hers&quot;</span>, <span class="st">&quot;daughter&quot;</span>)</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">sw &lt;-<span class="st"> </span><span class="kw">weat</span>(glove_math, S1, T1, A1, B1)</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="kw">weat_resampling</span>(sw)</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;  Resampling approximation of the exact test in Caliskan et al. (2017)</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; data:  sw</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; bias = 0.024865, p-value = 0.0158</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; alternative hypothesis: true bias is greater than 5.838753e-07</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt;       bias </span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt; 0.02486533</span></a></code></pre></div>
The method is extremely accurate. In the following simulation, we repeat the same resampling test for 50 times (which is still faster than conducting one exact test). The p-values are extremely close to the 0.018 repeated by Caliskan et al.
</p>
<div id="cb3" class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">weat_resampling</span>(sw)<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">hist</span>(res)</a></code></pre>
</div>
<p>
<img src="data:image/png;base64,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" /><!-- -->
</p>
<p>
The approximate can be increased by increasing the <code>n_resampling</code> parameter (default to 9999). In the Java code provided by Caliskan et al., this sets to 100000.
</p>
<div id="cb4" class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">weat_resampling</span>(sw, <span class="dt">n_resampling =</span> <span class="dv">15999</span>)<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">hist</span>(res)</a></code></pre>
</div>
<p>
<img src="data:image/png;base64,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" /><!-- -->
</p>
<p>
In the following example, we compare the exact inference with the resampling inference, when n = 5. On a regular computer, the exact test would take 1 minute.
</p>
<div id="cb5" class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">S2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;math&quot;</span>, <span class="st">&quot;algebra&quot;</span>, <span class="st">&quot;geometry&quot;</span>, <span class="st">&quot;calculus&quot;</span>, <span class="st">&quot;equations&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">T2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;poetry&quot;</span>, <span class="st">&quot;art&quot;</span>, <span class="st">&quot;dance&quot;</span>, <span class="st">&quot;literature&quot;</span>, <span class="st">&quot;novel&quot;</span>)</a>
<a class="sourceLine" id="cb5-3" title="3">A2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;boy&quot;</span>, <span class="st">&quot;brother&quot;</span>, <span class="st">&quot;he&quot;</span>, <span class="st">&quot;him&quot;</span>, <span class="st">&quot;his&quot;</span>, <span class="st">&quot;son&quot;</span>)</a>
<a class="sourceLine" id="cb5-4" title="4">B2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;woman&quot;</span>, <span class="st">&quot;girl&quot;</span>, <span class="st">&quot;sister&quot;</span>, <span class="st">&quot;she&quot;</span>, <span class="st">&quot;her&quot;</span>, <span class="st">&quot;hers&quot;</span>, <span class="st">&quot;daughter&quot;</span>)</a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6">sw3 &lt;-<span class="st"> </span><span class="kw">weat</span>(glove_math, T2, S2, A2, B2)</a>
<a class="sourceLine" id="cb5-7" title="7"></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="kw">system.time</span>(exact_res &lt;-<span class="st"> </span><span class="kw">weat_exact</span>(sw3))</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt;  74.011   0.748  74.777</span></a></code></pre>
</div>
<div id="cb6" class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">exact_res</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt;  The exact test in Caliskan et al. (2017)</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; data:  sw3</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; p-value = 0.9802</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; alternative hypothesis: greater</span></a></code></pre>
</div>
<div id="cb7" class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">weat_resampling</span>(sw3)<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">hist</span>(res, <span class="dt">main =</span> <span class="st">&quot;Distribution of p-values&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">abline</span>(<span class="dt">v =</span> exact_res<span class="op">$</span>p.value, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</a></code></pre>
</div>
<p>
<img src="data:image/png;base64,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" /><!-- -->
</p>
<!-- The method is extremely accurate. In the following simulation, we repeat the same resampling test for 50 times (which is still faster than conducting one exact test). The p-values are extremely close to the 0.018 repeated by Caliskan et al. -->
<!-- ```{r} -->
<!-- res <- replicate(50, weat_resampling(sw)$p.value) -->
<!-- hist(res) -->
<!-- ``` -->
<!-- The approximate can be increased by increasing the `n_resampling` parameter (default to 9999). In the Java code provided by Caliskan et al., this sets to 100000. -->
<!-- ```{r} -->
<!-- res <- replicate(50, weat_resampling(sw, n_resampling = 15999)$p.value) -->
<!-- hist(res) -->
<!-- ``` -->
<!-- In the following example, we compare the exact inference with the resampling inference, when n = 5. On a regular computer, the exact test would take 1 minute. -->
<!-- ```{r, eval = FALSE} -->
<!-- S2 <- c("math", "algebra", "geometry", "calculus", "equations") -->
<!-- T2 <- c("poetry", "art", "dance", "literature", "novel") -->
<!-- A2 <- c("male", "man", "boy", "brother", "he", "him", "his", "son") -->
<!-- B2 <- c("female", "woman", "girl", "sister", "she", "her", "hers", "daughter") -->
<!-- sw3 <- weat(glove_math, T2, S2, A2, B2) -->
<!-- system.time({exact_res <- weat_exact(sw3)}) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- exact_res -->
<!-- ``` -->
<!-- ```{r} -->
<!-- res <- replicate(100, weat_resampling(sw3)$p.value) -->
<!-- hist(res, main = "Distribution of p-values") -->
<!-- abline(v = exact_res$p.value, col = "red", lwd = 3) -->
<!-- ``` -->



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
